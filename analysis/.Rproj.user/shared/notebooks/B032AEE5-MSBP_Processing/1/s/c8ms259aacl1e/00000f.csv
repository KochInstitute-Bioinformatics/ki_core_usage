"0","# msbp.final %>%"
"0","#   filter(!is.na(Service.Group)) %>%"
"0","#   group_by(Service.Group, Sponsor_ForPlot) %>%"
"0","#   summarise(Total = sum(Adjusted.Total.Price, na.rm = TRUE), .groups = 'drop') %>%"
"0","#   complete(Service.Group, Sponsor_ForPlot, fill = list(Total = 0)) %>%"
"0","#   group_by(Service.Group) %>%"
"0","#   mutate(Service.Group.Total = sum(Total)) %>%"
"0","#   ungroup() %>%"
"0","#   mutate("
"0","#     Service.Group = fct_reorder(Service.Group, Service.Group.Total, .desc = TRUE),"
"0","#     Sponsor_ForPlot = factor(Sponsor_ForPlot, levels = sponsor_order)"
"0","#   ) %>%"
"0","#   ggplot(aes(x = Service.Group, y = Total, fill = Sponsor_ForPlot)) +"
"0","#   geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","#   scale_fill_manual(values = sponsor_colors) +"
"0","#   theme_minimal() +"
"0","#   theme("
"0","#     axis.text.x = element_text(angle = 45, hjust = 1),"
"0","#     plot.title = element_text(hjust = 0.5, size = 14, face = ""bold"")"
"0","#   ) +"
"0","#   labs("
"0","#     title = ""Adjusted Total Price by Service Group and Sponsor"","
"0","#     x = ""Service Group"","
"0","#     y = ""Adjusted Total Price ($)"","
"0","#     fill = ""Sponsor"""
"0","#   )"
