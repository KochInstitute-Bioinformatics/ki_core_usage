"0","lip.met.pie <- lip.met %>%"
"0","  mutate(Sponsor_ForPlot = factor(Sponsor_ForPlot, levels = sponsor_order)) %>%"
"0","  group_by(Sponsor_ForPlot) %>%"
"0","  summarise(Quantity = sum(Quantity), "
"0","            Num_Labs = if_else(first(Sponsor_ForPlot) == ""Center_Member"","
"0","                               n_distinct(Faculty.Key[Sponsor == ""KI_member""]),"
"0","                               n_distinct(Faculty.Key)),"
"0","            .groups = ""drop"") %>%"
"0","  mutate(Percent = round((Quantity / sum(Quantity)) * 100, 0),"
"0","         Lab_Label = if_else(Sponsor_ForPlot == ""Center_Member"","
"0","                             paste0(Num_Labs, "" Members""),"
"0","                             paste0(Num_Labs, "" Users"")),"
"0","         Label = paste0(Quantity, ""\n"", Percent, ""%\n"", Lab_Label)) %>%"
"0","  ggplot(aes(x = """", y = Quantity, fill = Sponsor_ForPlot)) +"
"0","  geom_col() +"
"0","  geom_text(aes(label = Label), "
"0","            position = position_stack(vjust = 0.5),"
"0","            size = 3,"
"0","            fontface = ""bold"","
"0","            color = ""white"") +"
"0","  coord_polar(""y"", start = 0) +"
"0","  scale_fill_manual(values = sponsor_colors) +"
"0","  labs(title = ""Lipid or Metabolite Profiling"","
"0","       fill = ""Sponsor"") +"
"0","  theme_void() +"
"0","  theme(legend.position = ""right"")"
"0",""
"0","lip.met.pie"
