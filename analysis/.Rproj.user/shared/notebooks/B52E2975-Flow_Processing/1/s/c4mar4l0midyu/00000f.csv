"0","# Define colors for each Sponsor (adjust these hex codes as needed)"
"0","sponsor_colors <- c("
"0","  ""KI_member"" = ""chocolate"","
"0","  ""KI_affiliate"" = ""orange"","
"0","  ""MIT_sponsor"" = ""steelblue"","
"0","  ""MIT_non_sponsor"" = ""lightblue"","
"0","  ""external"" = ""forestgreen"","
"0","  ""industry"" = ""grey"""
"0",")"
"0",""
"0","# Define order of sponsors for stacking (top to bottom)"
"0","sponsor_order <- c(""KI_member"", ""KI_affiliate"", ""MIT_sponsor"", ""MIT_non_sponsor"", ""external"", ""industry"")"
"0",""
"0","msbp.final %>%"
"0","  filter(!is.na(Service.Group)) %>%"
"0","  group_by(Service.Group, Sponsor) %>%"
"0","  summarise(Total = sum(Adjusted.Total.Price, na.rm = TRUE), .groups = 'drop') %>%"
"0","  group_by(Service.Group) %>%"
"0","  mutate(Service.Group.Total = sum(Total)) %>%"
"0","  ungroup() %>%"
"0","  mutate("
"0","    Service.Group = fct_reorder(Service.Group, Service.Group.Total, .desc = TRUE),"
"0","    Sponsor = factor(Sponsor, levels = sponsor_order)"
"0","  ) %>%"
"0","  ggplot(aes(x = Service.Group, y = Total, fill = Sponsor)) +"
"0","  geom_bar(stat = ""identity"") +"
"0","  scale_fill_manual(values = sponsor_colors) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    axis.text.x = element_text(angle = 45, hjust = 1),"
"0","    plot.title = element_text(hjust = 0.5, size = 14, face = ""bold"")"
"0","  ) +"
"0","  labs("
"0","    title = ""Adjusted Total Price by Service Group and Sponsor"","
"0","    x = ""Service Group"","
"0","    y = ""Adjusted Total Price ($)"","
"0","    fill = ""Sponsor"""
"0","  )"
"2","Error: object 'msbp.final' not found
"
